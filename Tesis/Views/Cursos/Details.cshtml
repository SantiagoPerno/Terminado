@model Tesis.ViewModels.CursoFichaMedicaViewModel

@{
    ViewData["Title"] = "Ficha médica";
}

<style>
    .tabla-ficha th,
    .tabla-ficha td {
        vertical-align: middle;
        text-align: center;
        padding: 12px;
    }

    .tabla-ficha thead th {
        background-color: #f8f9fa;
        font-weight: 600;
        border-bottom: 2px solid #dee2e6;
    }

    .tabla-ficha tbody tr {
        border-bottom: 1px solid #dee2e6;
    }

        .tabla-ficha tbody tr:hover {
            background-color: #f2f2f2;
        }

    .checkbox-rounded {
        appearance: none;
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        border: 2px solid #999;
        background-color: white;
        outline: none;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
    }

        .checkbox-rounded:checked {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

    .btn-volver {
        margin-top: 20px;
    }

    h2 {
        font-weight: 700;
        margin-bottom: 25px;
    }
</style>

<h2>Estudiantes de: @Model.Curso.Nombre</h2>

<form asp-action="GuardarFichaMedica" method="post">
    <input type="hidden" name="cursoId" value="@Model.Curso.Id" />

    <table class="table tabla-ficha">
        <thead>
            <tr>
                <th>Estudiante</th>
                <th>Faltas totales</th>
                <th colspan="8" class="text-center">📋 Legajo estudiante</th>
            </tr>
            <tr>
                <th></th>
                <th></th>
                <th>Dni</th>
                <th>Dni padre</th>
                <th>Dni madre</th>
                <th>Dni tutor/ra</th>
                <th>Partida de nacimiento</th>
                <th>CUS</th>
                <th>ISA</th>
                <th>Constancia domicilio</th>
            </tr>
        </thead>
        <tbody>
            @{
                int index = 0;
            }
            @foreach (var estudiante in Model.Estudiantes)
            {
                <tr>
                    <td class="text-start">@estudiante.Nombre @estudiante.Apellido</td>
                    <td>@estudiante.TotalFaltasCalculadas.ToString("0.##")</td>

                    <!-- ID oculto para este índice -->
                    <input type="hidden" name="datos[@index].Id" value="@estudiante.Id" />

                    <td>
                        <input class="checkbox-rounded" type="checkbox" name="datos[@index].TieneDni" value="true" @(estudiante.TieneDni ? "checked" : "") />
                        <input type="hidden" name="datos[@index].TieneDni" value="false" />
                    </td>
                    <td>
                        <input class="checkbox-rounded" type="checkbox" name="datos[@index].TieneDniPadre" value="true" @(estudiante.TieneDniPadre ? "checked" : "") />
                        <input type="hidden" name="datos[@index].TieneDniPadre" value="false" />
                    </td>
                    <td>
                        <input class="checkbox-rounded" type="checkbox" name="datos[@index].TieneDniMadre" value="true" @(estudiante.TieneDniMadre ? "checked" : "") />
                        <input type="hidden" name="datos[@index].TieneDniMadre" value="false" />
                    </td>
                    <td>
                        <input class="checkbox-rounded" type="checkbox" name="datos[@index].TieneDniTutor" value="true" @(estudiante.TieneDniTutor ? "checked" : "") />
                        <input type="hidden" name="datos[@index].TieneDniTutor" value="false" />
                    </td>
                    <td>
                        <input class="checkbox-rounded" type="checkbox" name="datos[@index].TienePartidaNacimiento" value="true" @(estudiante.TienePartidaNacimiento ? "checked" : "") />
                        <input type="hidden" name="datos[@index].TienePartidaNacimiento" value="false" />
                    </td>
                    <td>
                        <input class="checkbox-rounded" type="checkbox" name="datos[@index].TieneCUS" value="true" @(estudiante.TieneCUS ? "checked" : "") />
                        <input type="hidden" name="datos[@index].TieneCUS" value="false" />
                    </td>
                    <td>
                        <input class="checkbox-rounded" type="checkbox" name="datos[@index].TieneISA" value="true" @(estudiante.TieneISA ? "checked" : "") />
                        <input type="hidden" name="datos[@index].TieneISA" value="false" />
                    </td>
                    <td>
                        <input class="checkbox-rounded" type="checkbox" name="datos[@index].TieneConstanciaDomicilio" value="true" @(estudiante.TieneConstanciaDomicilio ? "checked" : "") />
                        <input type="hidden" name="datos[@index].TieneConstanciaDomicilio" value="false" />
                    </td>
                </tr>
                index++;
            }
        </tbody>
    </table>

    <div class="d-flex justify-content-start mt-3">
        <a asp-action="Index" class="btn btn-secondary me-2">
            <i class="bi bi-arrow-left"></i> Volver
        </a>

        <button type="submit" class="btn btn-primary px-4">
            <i class="bi bi-save me-2"></i>Guardar cambios
        </button>
    </div>
</form>
